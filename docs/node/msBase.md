---
title: Node 基础一
---

## 在每个 tick 的过程中，如何判断是否有事件需要处理呢

1. 每个事件循环中有一个或者多个观察者，而判断是否有事件需要处理的过程就是向这些 观察者询问是否有要处理的事件。
2. 在 Node 中，事件主要来源于网络请求、文件的 I/O 等，这些事件对应的观察者有文件 I/O 观察者，网络 I/O 的观察者。
3. 事件循环是一个典型的生产者/消费者模型。异步 I/O，网络请求等则是事件的生产者， 源源不断为 Node 提供不同类型的事件，这些事件被传递到对应的观察者那里，事件循环 则从观察者那里取出事件并处理。
4. 在 windows 下，这个循环基于 IOCP 创建，在\*nix 下则基于多线程创建

## 请描述一下整个异步 I/O 的流程

![node-io](/assets/images/node-io.png)

## V8 的内存限制是多少，为什么 V8 这样设计

64 位系统下是 1.4GB， 32 位系统下是 0.7GB。因为 1.5GB 的垃圾回收堆内存，V8 需要 花费 50 毫秒以上，做一次非增量式的垃圾回收甚至要 1 秒以上。这是垃圾回收中引起 Javascript 线程暂停执行的事件，在这样的花销下，应用的性能和影响力都会直线下降。

## Node. js 中的事件循环是什么样的

事件循环其实就是一个事件队列，先加入先执行，执行完一次队列，再次循环遍历看有没 有新事件加入队列。<br>
执行中的事件叫 IO 事件，setlmmediate 在当前队列中立即执行，setTimout/setInterval 把执行定时到下一个队列， process. nextTick 在当前队列执行完，下次遍历前执行。所以总体顺序是 ： IO 事件 → setImmediate → setTimeout/setInterval → process. nextTick。

## Node. js 的优缺点是什么

**优点如下：**

1. Node. js 是基于事件驱动和无阻塞的，非常适合处理并发请求，因此构建在 Node. js 的代理服务器相比其他技术实现的服务器要好一点。
2. 与 Node. js 代理服务器交互的客户端代码由 JavaScript 语言编写，客户端与服务端 都采用一种语言编写。

**缺点如下：**

1. Node .js 是一个相对新的开源项目，不太稳定，变化速度快。
2. 不适合 CPU 密集型应用，如果有长时间运行的计算（比如大循环），将会导致 CPU 时间片不能释放，使得后续 I/O 无法发起。

## npm 的作用是什么

npm 是同 Node .js 一起安装的包管理工具，能解决 Node. js 代码部署上的很多问题。

**常见的使用场景有以下几种。**

1. 允许用户从 npm 服务器下载别人编写的第三方包到本地。
2. 允许用户从 npm 服务器下载并安装别人编写的命令行程序到本地。
3. 允许用户将自己编写的包或命令行程序上传到 npm 服务器供别人使用。

## 有哪些常用 Stream 流？分别什么时候使用？

Readable 流为可读流，在作为输入数据源时使用；Writable 流为可写流，在作为输岀源 时使用；Duplex 流为可读写流，它作为输岀源被写入，同时又作为输入源被后面的流读出。 Transform 流和 Duplex 流一样，都是双向流，区别是 Transfrom 流只需要实现一个函数 \_transfrom( chunk, encoding, callback)；而 Duplex 流需要分别实现\_read(size )函数 和\_write( chunk, encoding, callback ）函数。

## Nginx 和 Apache 有什么区别

Nginx 是轻量级的，同样的 Web 服务在 nginx 中会占用更少的内存和资源。Nginx 抗并 发，处理请求的方式是异步非阻塞的，负载能力比 Apache 高很多，而 Apache 则是阻塞 型的。

在高并发下 Nginx 能保持低资源、低消耗、高性能，并且处理静态文件比 Apache 好。 Nginx 的设计高度模块化，编写模块相对简单，配置简洁。作为负載均衡服务器，支持 7 层负载均衡，是一个反向代理服务器。

社区活跃，各种高性能模块出品迅速。Apache 的 rewrite 比 Nginx 强大，模块丰富。 Apache 发展得更为成熟，Bug 很少,更加稳定。

Apache 对 PHP 的支持比较简单， Nginx 需要配合其他后端使用。Apache 处理动态请求 有优势，拥有丰富的特性、成熟的技术和开发社区。

## 说说线程与进程的区别

（1）一个程序至少有一个进程，一个进程至少有一个线程。<br>
（2）线程的划分尺度小于进程，使得多线程程序的并发性高。<br>
（3）进程在执行过程中拥有独立的内存单元，而多个线程共享内存，极大地提高了程序的 运行效率。<br>
（4）线程在执行过程中与进程有区别。每个独立的线程都有程序运行的入口、顺序执行序 列和程序的出口。但是线程不能够独立执行，必须依存在应用程序中，由应用程序提供多 个线程执行控制。<br>
（5）从逻辑角度来看，多线程的意义在于一个应用程序中，有多个执行部分可以同时执行。 但操作系统并没有将多个线程看作多个独立的应用来实现进程的调度、管理和资源分配。 这是进程和线程的主要区别。

## node 中的异步和同步怎么理解

node 是单线程的，异步是通过一次次的循环事件队列来实现的．同步则是说阻塞式的 IO, 这在高并发环境会是一个很大的性能问题，所以同步一般只在基础框架的启动时使用，用 来加载配置文件，初始化程序什么的

## 有哪些方法可以进行异步流程的控制

1. 多层嵌套回调
2. 为每一个回调写单独的函数，函数里边再回调
3. 用第三方框架比方 async, q, promise 等
